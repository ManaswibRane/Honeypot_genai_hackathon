import psycopg2
from langchain.schema import Document

def load_exploitdb():
    conn = psycopg2.connect(
        host="localhost",
        database="exploitdb",
        user="exploitdb",
        password="exploitdb"
    )

    cur = conn.cursor()
    cur.execute("SELECT description, type, platform FROM exploits LIMIT 500")
    rows = cur.fetchall()

    docs = []
    for desc, etype, platform in rows:
        docs.append(
            Document(
                page_content=f"""
Exploit Type: {etype}
Platform: {platform}
Description: {desc}
""",
                metadata={"source": "ExploitDB"}
            )
        )

    cur.close()
    conn.close()
    return docs
