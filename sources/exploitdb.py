import csv
from langchain.schema import Document

def load_exploitdb():
    docs = []
    with open('RAG/files_exploits.csv', 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        for row in reader:
            content = f"""
EB_ID: {row['id']}
Description: {row['description']}
Date Published: {row['date_published']}
Author: {row['author']}
Type: {row['type']}
Platform: {row['platform']}
"""
            if row['codes']:
                content += f"Codes: {row['codes']}\n"
            if row['tags']:
                content += f"Tags: {row['tags']}\n"
            docs.append(
                Document(
                    page_content=content,
                    metadata={"source": "ExploitDB", "eb_id": row['id']}
                )
            )
    return docs
